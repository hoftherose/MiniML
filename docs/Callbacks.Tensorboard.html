---

title: Tensorboard

keywords: fastai
sidebar: home_sidebar

summary: "Learning to use the tensorboard callback in fastaiv2"
description: "Learning to use the tensorboard callback in fastaiv2"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/Callbacks.Tensorboard.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Could not do one pass in your dataloader, there is something wrong in it
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Recap">Recap<a class="anchor-link" href="#Recap"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notes following the first lesson of the fastai 2019 Deep Learning for Practitioners Course. Code follows the lesson using fastaiv2, fastcore and is documented using the nbdev library.</p>
<p>To start make sure you can import the fastai2 library and nbdev.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">PETS</span><span class="p">)</span>
<span class="n">path_anno</span><span class="p">,</span> <span class="n">path_img</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="n">folder</span> <span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()]</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path_img</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/(\w+)_\d+.jpg&#39;</span>
<span class="n">dblock</span> <span class="o">=</span> <span class="n">DataBlock</span><span class="p">((</span><span class="n">ImageBlock</span><span class="p">,</span><span class="n">CategoryBlock</span><span class="p">),</span>
                    <span class="n">splitter</span><span class="o">=</span><span class="n">RandomSplitter</span><span class="p">(),</span>
                    <span class="n">get_items</span><span class="o">=</span><span class="n">get_image_files</span><span class="p">,</span>
                    <span class="n">item_tfms</span><span class="o">=</span><span class="n">Resize</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span>
                    <span class="n">batch_tfms</span><span class="o">=</span><span class="n">aug_transforms</span><span class="p">(),</span>
                    <span class="n">get_y</span><span class="o">=</span><span class="n">RegexLabeller</span><span class="p">(</span><span class="n">pat</span><span class="p">))</span>

<span class="n">dls</span> <span class="o">=</span> <span class="n">dblock</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">path_img</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="TensorBoard">TensorBoard<a class="anchor-link" href="#TensorBoard"> </a></h1><p>Next we are going to integrate tensorboard to our training.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Tensorboard is a tool developed by Google which can be used to visualize your model training. This helps us run multiple tests and compair training speed, preformance, errors/metrics, etc. Although this tool was initially made for tensorflow, in pytorch version 1.1.0 we can import the tensorboard callback to add the same functionality (or atleast, enough).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorboard</span>
<span class="kn">from</span> <span class="nn">fastai2.callback.tensorboard</span> <span class="kn">import</span> <span class="n">TensorBoardCallback</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before using tensorboard we must add it's run file path.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">project_id</span> <span class="o">=</span> <span class="s2">&quot;TensorBoardCallback&quot;</span>
<span class="n">tboard_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../tensorboard/&#39;</span> <span class="o">+</span> <span class="n">project_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In fastai2, since we can't modify the learner object and change the learning workflow we can just add the Tensorboard callback from the fastai2 library. Similar to the SaveModelCallback, we can just add the callback to our cbs parameter in our fit method.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorBoardCallback</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="n">tboard_path</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#show</span>
<span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">resnet34</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">error_rate</span><span class="p">)</span>
<span class="n">learner</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">cbs</span><span class="o">=</span><span class="n">callbacks</span><span class="p">)</span>
<span class="n">learner</span><span class="o">.</span><span class="n">show_results</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/holydemon/.local/anaconda3/envs/fai2/lib/python3.7/site-packages/torch/jit/__init__.py:1007: TracerWarning: Output nr 1. of the traced function does not match the corresponding output of the Python function. Detailed error:
Not within tolerance rtol=1e-05 atol=1e-05 at input[10, 345] (0.01734388992190361 vs. 0.017373453825712204) and 200 other locations (1.00%)
  check_tolerance, _force_outplace, True, _module_class)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>error_rate</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.847933</td>
      <td>2.191939</td>
      <td>0.570365</td>
      <td>01:49</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.423011</td>
      <td>1.351534</td>
      <td>0.406631</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.740449</td>
      <td>0.641080</td>
      <td>0.205683</td>
      <td>01:47</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.476707</td>
      <td>00:39</td>
    </tr>
  </tbody>
</table>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-0eeb0c5e7a98&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg">#show</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> learner <span class="ansi-blue-fg">=</span> Learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> resnet34<span class="ansi-blue-fg">(</span>pretrained<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> metrics<span class="ansi-blue-fg">=</span>error_rate<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>learner<span class="ansi-blue-fg">.</span>fit_one_cycle<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span>callbacks<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> learner<span class="ansi-blue-fg">.</span>show_results<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/callback/schedule.py</span> in <span class="ansi-cyan-fg">fit_one_cycle</span><span class="ansi-blue-fg">(self, n_epoch, lr_max, div, div_final, pct_start, wd, moms, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    110</span>     scheds = {&#39;lr&#39;: combined_cos(pct_start, lr_max/div, lr_max, lr_max/div_final),
<span class="ansi-green-intense-fg ansi-bold">    111</span>               &#39;mom&#39;: combined_cos(pct_start, *(self.moms if moms is None else moms))}
<span class="ansi-green-fg">--&gt; 112</span><span class="ansi-red-fg">     </span>self<span class="ansi-blue-fg">.</span>fit<span class="ansi-blue-fg">(</span>n_epoch<span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span>ParamScheduler<span class="ansi-blue-fg">(</span>scheds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">+</span>L<span class="ansi-blue-fg">(</span>cbs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> reset_opt<span class="ansi-blue-fg">=</span>reset_opt<span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span>wd<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    113</span> 
<span class="ansi-green-intense-fg ansi-bold">    114</span> <span class="ansi-red-fg"># Cell</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-fg">(self, n_epoch, lr, wd, cbs, reset_opt)</span>
<span class="ansi-green-intense-fg ansi-bold">    183</span>                     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span>                         self<span class="ansi-blue-fg">.</span>epoch<span class="ansi-blue-fg">=</span>epoch<span class="ansi-blue-fg">;</span>          self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_epoch&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 185</span><span class="ansi-red-fg">                         </span>self<span class="ansi-blue-fg">.</span>_do_epoch_train<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    186</span>                         self<span class="ansi-blue-fg">.</span>_do_epoch_validate<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span>                     <span class="ansi-green-fg">except</span> CancelEpochException<span class="ansi-blue-fg">:</span>   self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_epoch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">_do_epoch_train</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    157</span>             self<span class="ansi-blue-fg">.</span>dl <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dls<span class="ansi-blue-fg">.</span>train<span class="ansi-blue-fg">;</span>                        self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;begin_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 158</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>all_batches<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    159</span>         <span class="ansi-green-fg">except</span> CancelTrainException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_train&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    160</span>         <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>                                             self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_train&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">all_batches</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    134</span>     <span class="ansi-green-fg">def</span> all_batches<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    135</span>         self<span class="ansi-blue-fg">.</span>n_iter <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 136</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> enumerate<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>one_batch<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    137</span> 
<span class="ansi-green-intense-fg ansi-bold">    138</span>     <span class="ansi-green-fg">def</span> one_batch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> i<span class="ansi-blue-fg">,</span> b<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/learner.py</span> in <span class="ansi-cyan-fg">one_batch</span><span class="ansi-blue-fg">(self, i, b)</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span>             <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> self<span class="ansi-blue-fg">.</span>training<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span>             self<span class="ansi-blue-fg">.</span>loss<span class="ansi-blue-fg">.</span>backward<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                            self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_backward&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 147</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>step<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span>                                 self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_step&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    148</span>             self<span class="ansi-blue-fg">.</span>opt<span class="ansi-blue-fg">.</span>zero_grad<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    149</span>         <span class="ansi-green-fg">except</span> CancelBatchException<span class="ansi-blue-fg">:</span>                         self<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;after_cancel_batch&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/optimizer.py</span> in <span class="ansi-cyan-fg">step</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     70</span> 
<span class="ansi-green-intense-fg ansi-bold">     71</span>     <span class="ansi-green-fg">def</span> step<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 72</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> p<span class="ansi-blue-fg">,</span>pg<span class="ansi-blue-fg">,</span>state<span class="ansi-blue-fg">,</span>hyper <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>all_params<span class="ansi-blue-fg">(</span>with_grad<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     73</span>             <span class="ansi-green-fg">for</span> cb <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>cbs<span class="ansi-blue-fg">:</span> state <span class="ansi-blue-fg">=</span> _update<span class="ansi-blue-fg">(</span>state<span class="ansi-blue-fg">,</span> cb<span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span><span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">**</span>state<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>hyper<span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     74</span>             self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">[</span>p<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> state

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/optimizer.py</span> in <span class="ansi-cyan-fg">all_params</span><span class="ansi-blue-fg">(self, n, with_grad)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>     <span class="ansi-green-fg">def</span> all_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> n<span class="ansi-blue-fg">=</span>slice<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> with_grad<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         res <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">,</span>pg<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">[</span>p<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>hyper<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> pg<span class="ansi-blue-fg">,</span>hyper <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>param_groups<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>hypers<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> p <span class="ansi-green-fg">in</span> pg<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 16</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> L<span class="ansi-blue-fg">(</span>o <span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> res <span class="ansi-green-fg">if</span> o<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>grad <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> with_grad <span class="ansi-green-fg">else</span> res
<span class="ansi-green-intense-fg ansi-bold">     17</span> 
<span class="ansi-green-intense-fg ansi-bold">     18</span>     <span class="ansi-green-fg">def</span> _set_require_grad<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> rg<span class="ansi-blue-fg">,</span> p<span class="ansi-blue-fg">,</span>pg<span class="ansi-blue-fg">,</span>state<span class="ansi-blue-fg">,</span>h<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> p<span class="ansi-blue-fg">.</span>requires_grad_<span class="ansi-blue-fg">(</span>rg <span class="ansi-green-fg">or</span> state<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;force_train&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(cls, x, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span>             <span class="ansi-green-fg">return</span> x
<span class="ansi-green-intense-fg ansi-bold">     41</span> 
<span class="ansi-green-fg">---&gt; 42</span><span class="ansi-red-fg">         </span>res <span class="ansi-blue-fg">=</span> super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__call__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     43</span>         res<span class="ansi-blue-fg">.</span>_newchk <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>         <span class="ansi-green-fg">return</span> res

<span class="ansi-green-fg">~/Documents/fastai/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, items, use_list, match, *rest)</span>
<span class="ansi-green-intense-fg ansi-bold">    311</span>         <span class="ansi-green-fg">if</span> items <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> items <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    312</span>         <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span>use_list <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> <span class="ansi-green-fg">not</span> _is_array<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 313</span><span class="ansi-red-fg">             </span>items <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> use_list <span class="ansi-green-fg">else</span> _listify<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    314</span>         <span class="ansi-green-fg">if</span> match <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    315</span>             <span class="ansi-green-fg">if</span> is_coll<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> match <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>match<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Documents/fastai/fastcore/fastcore/foundation.py</span> in <span class="ansi-cyan-fg">_listify</span><span class="ansi-blue-fg">(o)</span>
<span class="ansi-green-intense-fg ansi-bold">    247</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> o
<span class="ansi-green-intense-fg ansi-bold">    248</span>     <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> _is_array<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 249</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">if</span> is_iter<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> list<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    250</span>     <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">[</span>o<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span> 

<span class="ansi-green-fg">~/Documents/fastai/fastai2/fastai2/optimizer.py</span> in <span class="ansi-cyan-fg">&lt;genexpr&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>     <span class="ansi-green-fg">def</span> all_params<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> n<span class="ansi-blue-fg">=</span>slice<span class="ansi-blue-fg">(</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> with_grad<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         res <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">,</span>pg<span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">[</span>p<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>hyper<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> pg<span class="ansi-blue-fg">,</span>hyper <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>param_groups<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>self<span class="ansi-blue-fg">.</span>hypers<span class="ansi-blue-fg">[</span>n<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> p <span class="ansi-green-fg">in</span> pg<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 16</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> L<span class="ansi-blue-fg">(</span>o <span class="ansi-green-fg">for</span> o <span class="ansi-green-fg">in</span> res <span class="ansi-green-fg">if</span> o<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">.</span>grad <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> with_grad <span class="ansi-green-fg">else</span> res
<span class="ansi-green-intense-fg ansi-bold">     17</span> 
<span class="ansi-green-intense-fg ansi-bold">     18</span>     <span class="ansi-green-fg">def</span> _set_require_grad<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> rg<span class="ansi-blue-fg">,</span> p<span class="ansi-blue-fg">,</span>pg<span class="ansi-blue-fg">,</span>state<span class="ansi-blue-fg">,</span>h<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> p<span class="ansi-blue-fg">.</span>requires_grad_<span class="ansi-blue-fg">(</span>rg <span class="ansi-green-fg">or</span> state<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;force_train&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To see the results of the training you can run the cli command from tensorboard <code>tensorboard --logdir=tensorboard</code></p>

</div>
</div>
</div>
    {% endraw %}
</div>
 

